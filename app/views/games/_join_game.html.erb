<!-- Game information -->
<div class="join-game">
  <h4>This game will take place <strong><%= @game.date.strftime('%a %d %b %Y') %></strong> at <strong><%= @game.time.strftime('%I:%M pm') %></strong> at <strong><%= @game.metro_station %></strong></h4>
<!--   map box -->
<div
  id="map"
  style="width: 100%;
  height: 300px;"
  data-markers="<%= @markers.to_json %>"
></div>


  <p>Number of players: <%= @game.number_of_players / 2 - 1 %> x <%= @game.number_of_players / 2 - 1 %></p>


  <!--   Check if user is already registered for the game, join the game -->
  <% players = @game.bookings.to_a.map { |booking| booking.user } %>
  <% if players.include?(current_user) %>
    <p>You're already registered for this game</p>
  <% elsif players.length >= @game.number_of_players %>
    <p>This game is already full</p>
  <% else %>
  <p>Price: <%= humanized_money_with_symbol(@game.price) %></p>
    <%= simple_form_for @booking do |f| %>
    <div class="form-actions" style="text-align: center; ">
      <%= f.button :submit, 'Join this game', class: "btn btn-primary" %>
      <% end %>
    </div>
      <script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
    Stripe.setPublishableKey('STRIPE_PUBLISHABLE_KEY');
    data-key="<%= Rails.configuration.stripe[:publishable_key] %>"
    data-name="My game"
    data-email="<%= current_user.email %>"
    data-description="game <%= @booking.game_id %>"
    data-amount="<%= @booking.amount_cents %>"
    data-currency="<%= @booking.amount.currency %>"></script>
    </div>
  <% end %>

</div>
